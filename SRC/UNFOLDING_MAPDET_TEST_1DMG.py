import numpy as np
import time
import os
import sys

# Prevent .pyc file generation
os.environ['PYTHONDONTWRITEBYTECODE'] = '1'
sys.dont_write_bytecode = True

start_time = time.time()

from SRC_UNFOLDING_1D import *

#######################################################################################################
ABS1 = [1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, 1.150000e-02, ]
ABS2 = [1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, 1.019000e-01, ]
D1 = [1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, 1.437600e+00, ]
D2 = [3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, 3.723000e-01, ]
NUFIS1 = [5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, 5.700000e-03, ]
NUFIS2 = [1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, 1.425000e-01, ]
REM = [1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, 1.510000e-02, ]
X_NUM = [-150, -149, -148, -147, -146, -145, -144, -143, -142, -141, -140, -139, -138, -137, -136, -135, -134, -133, -132, -131, -130, -129, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, ]

dREM = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ]
Beff = 5.350000e-03
f = 1
l = 8.510000e-02
omega = 2 * np.pi * f
v1 = 18230400
v2 = 413067

# INITIALIZATION
case_name_base = "OBJECTIVES7_MAPDET_TEST_1DMG_CSTest03"
case_name2 = "OBJECTIVES7_MAPDET_TEST_1DMG_CSTest03"
a = 150
N = 301
dx = (2*a) / (N-1)
x = np.arange(-a, a+dx, dx)
group = 2

# BC
BC = [3, 3] # left, right

# CROSS SECTION DEFINITIONS
SIGS12 = REM
SIGS21 = [0.0 for _ in range(N)]
SIGS11 = [0.0 for _ in range(N)]
SIGS22 = [0.0 for _ in range(N)]
SIGS = [[SIGS11, SIGS21], [SIGS12, SIGS22]]
TOT1 = [x + y for x, y in zip(ABS1, SIGS12)]
TOT2 = [x + y for x, y in zip(ABS2, SIGS21)]
D = [D1, D2]
TOT = [TOT1, TOT2]
NUFIS = [NUFIS1, NUFIS2]
chi1 = [1.0 for _ in range(N)]
chi2 = [0.0 for _ in range(N)]
chi = [chi1, chi2]

dSIGS12 = dREM
dSIGS21 = [0.0 for _ in range(N)]
dSIGS11 = [0.0 for _ in range(N)]
dSIGS22 = [0.0 for _ in range(N)]
dSIGS = [[dSIGS11, dSIGS21], [dSIGS12, dSIGS22]]
dABS1 = [0.0 for _ in range(N)]
dABS2 = [0.0 for _ in range(N)]
dNUFIS1 = [0.0 for _ in range(N)]
dNUFIS2 = [0.0 for _ in range(N)]
dNUFIS = [dNUFIS1, dNUFIS2]
dTOT1 = [x + y for x, y in zip(dABS1, dSIGS12)]
dTOT2 = [x + y for x, y in zip(dABS2, dSIGS21)]
dTOT = [dTOT1, dTOT2]
dSOURCE1 = [0.0 for _ in range(N)]
dSOURCE2 = [0.0 for _ in range(N)]
dSOURCE = [dSOURCE1, dSOURCE2]
v1 = np.ones(N)*v1
v2 = np.ones(N)*v2
v = [v1, v2]

## ILU PRE-CONDITIONER
precond = 0
geom_type = '1D'
type_noise = 'AVS'

# MAP DETECTOR
map_detector = np.zeros((N))
det_id = np.linspace(0, N-1, 50).astype(int)
map_detector[det_id] = 1

########################################################################################################
output_dir = f'../OUTPUTS/{case_name_base}'

##### Forward Simulation
solver_type = 'forward'
os.makedirs(f'{output_dir}/{case_name2}_{solver_type.upper()}', exist_ok=True)
matrix_builder = MatrixBuilderForward1D(group, N, TOT, SIGS, BC, dx, D, chi, NUFIS)
M, F_FORWARD = matrix_builder.build_forward_matrices()
solver = SolverFactory.get_solver_power1D(solver_type, group, N, M, F_FORWARD, dx, precond, tol=1E-6)
keff, PHI = solver.solve()
PHI_reshaped = np.reshape(PHI, (group, N))
output = {"keff": keff}
for g in range(len(PHI_reshaped)):
    phi_groupname = f'PHI{g + 1}_{solver_type.upper()}'
    output[phi_groupname] = [val.real for val in PHI_reshaped[g]]
with open(f'{output_dir}/{case_name2}_{solver_type.upper()}/{case_name2}_{solver_type.upper()}_output.json', 'w') as json_file:
    json.dump(output, json_file, indent=4)

##### Adjoint Simulation
solver_type = 'adjoint'
os.makedirs(f'{output_dir}/{case_name2}_{solver_type.upper()}', exist_ok=True)
matrix_builder = MatrixBuilderAdjoint1D(group, N, TOT, SIGS, BC, dx, D, chi, NUFIS)
M, F_ADJOINT = matrix_builder.build_adjoint_matrices()
solver = SolverFactory.get_solver_power1D(solver_type, group, N, M, F_ADJOINT, dx, precond, tol=1E-6)
keff, PHI_ADJ = solver.solve()
PHI_ADJ_reshaped = np.reshape(PHI_ADJ, (group, N))
output = {"keff": keff}
for g in range(len(PHI_ADJ_reshaped)):
    phi_groupname = f'PHI{g + 1}_{solver_type.upper()}'
    output[phi_groupname] = [val.real for val in PHI_reshaped[g]]
with open(f'{output_dir}/{case_name2}_{solver_type.upper()}/{case_name2}_{solver_type.upper()}_output.json', 'w') as json_file:
    json.dump(output, json_file, indent=4)

# Get all initial indices with value 1
active_indices = np.where(map_detector == 1)[0]
np.random.shuffle(active_indices)  # randomize order of deactivation

validity_INVERT = []
validity_SCAN = []
validity_BRUTE = []
validity_BACK = []
validity_GREEDY = []
methods = ["INVERT", "SCAN", "BRUTE", "BACK", "GREEDY"]

# Check if the file exists, if yes, delete it
iter_file = f"../OUTPUTS/{case_name_base}/iteration_info.txt"
if os.path.exists(iter_file):
    os.remove(iter_file)
    print(f"Existing file '{iter_file}' deleted.")

for i, idx in enumerate(active_indices):
    case_name = f'{case_name2}_iter{i}'

    # Append to file without changing loop structure
    with open(iter_file, "a") as file:
        file.write(f"Iteration: {i+1}, number of active detectors: {np.sum(map_detector == 1)}\n")

    # Append map_detector to a separate file
    with open(f"../OUTPUTS/{case_name_base}/map_detector_iter{i}.txt", "w") as f_map:
        f_map.write("map_detector = [")
        f_map.write(", ".join(str(int(x)) for x in map_detector))
        f_map.write("]\n")

    dPHI = main_unfold_1D_noise(PHI, keff, group, N, TOT, SIGS, BC, dx, D, chi, NUFIS, precond, v, Beff, omega, l, dTOT, dSIGS, dNUFIS, dSOURCE, output_dir, case_name, x)
    G_matrix = main_unfold_1D_green(PHI, keff, group, N, TOT, SIGS, BC, dx, D, chi, NUFIS, precond, v, Beff, omega, l, dTOT, dSIGS, dNUFIS, dSOURCE, output_dir, case_name, x)
    S, dPHI_meas = main_unfold_1D_solve(PHI, G_matrix, dPHI, keff, group, N, TOT, SIGS, BC, dx, D, chi, NUFIS, precond, v, Beff, omega, l, dTOT, dSIGS, dNUFIS, dSOURCE, map_detector, output_dir, case_name, x)

    try:
        dPHI_INVERT, dS_unfold_INVERT = main_unfold_1D_invert(dPHI_meas, dPHI, S, G_matrix, group, N, map_detector, output_dir, case_name, x)
        dS_unfold_SCAN = main_unfold_1D_scan(dPHI_meas, dPHI, S, G_matrix, group, N, map_detector, output_dir, case_name, x)
        if np.allclose(S, dS_unfold_INVERT, atol=1E-06):
            validity_INVERT.append('yes')
        else:
            validity_INVERT.append('no')
        if np.allclose(S, dS_unfold_SCAN, atol=1E-06):
            validity_SCAN.append('yes')
        else:
            validity_SCAN.append('no')
    except Exception as e:
        print(f"Unfolding failed: {e}")

        # Append failure indicators
        validity_INVERT.append('fail')
        validity_SCAN.append('fail')    

    try:
        dPHI_BRUTE, dS_unfold_BRUTE = main_unfold_1D_brute(dPHI_meas, dPHI, S, G_matrix, group, N, output_dir, case_name, x)
        if np.allclose(S, dS_unfold_BRUTE, atol=1E-06):
            validity_BRUTE.append('yes')
        else:
            validity_BRUTE.append('no')
    except Exception as e:
        print(f"Unfolding failed: {e}")

        # Append failure indicators
        validity_BRUTE.append('fail')

    try:
        dPHI_GREEDY, dS_unfold_GREEDY = main_unfold_1D_greedy_new(dPHI_meas, dPHI, S, G_matrix, group, N, output_dir, case_name, x)
        if np.allclose(S, dS_unfold_GREEDY, atol=1E-06):
            validity_GREEDY.append('yes')
        else:
            validity_GREEDY.append('no')
    except Exception as e:
        print(f"Unfolding failed: {e}")

        # Append failure indicators
        validity_GREEDY.append('fail')

    validity = [validity_INVERT, validity_SCAN, validity_BRUTE, validity_BACK, validity_GREEDY]
    with open(f"../OUTPUTS/{case_name_base}/output_validity.txt", "w") as f:
        for category, lst in zip(methods, validity):
            f.write(f"{category} " + ", ".join(lst) + "\n")

    map_detector[idx] = 0